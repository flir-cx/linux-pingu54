# SPDX-License-Identifier: GPL-2.0-only OR BSD-2-Clause
# Copyright (C) 2022 Flir Teledyne
%YAML 1.2
---
$id: http://devicetree.org/schemas/misc/flir,ema100080.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: eMagin lcd bindings

description: |
  This binding describes the flir implementation of eMagin 100080 on Flir
  platforms using a adv1723 converter from an lcd interface on host processor.

maintainers:
  - Flir Teledyne

properties:
  compatible:
    const: flir,ema100080

  eoco-fvm-psave-gpio:
    description: GPIO specifier for psave signal on adv1723
    maxItems: 1

  i2c-config-cmds:
    description: Command array in tuples of 2 bytes used to init ema 100080
                 Maximum 32 tuples (64 values)
    maxItems: 64

  reg:
    description: i2c address, 7bit, where the emagin 100080 resides

required:
  - compatible
  - eoco-fvm-psave-gpio
  - i2c-config-cmds

additionalProperties: false

examples:
  - |
    #include <dt-bindings/gpio/gpio.h>

    flir_ema100080: flir_ema100080@32 {
		compatible = "flir,ema100080";
		pinctrl-names = "default";
		pinctrl-0 = <&pinctrl_viewfinder>;

		eoco-fvm-psave-gpio = <&gpio4 17 GPIO_ACTIVE_HIGH>;

		reg = <0x32>;
		// These were taken from old ce driver. It is essentially SVGA_60, from page 45 in the eMagin 100080 datasheet
		// So this is the setup for the 800x600, this needs to match what is setup in mxc_lcdif (nxp code)
		i2c-config-cmds =	<0x01 0x80>, // Red Analog Input Gain
					<0x02 0x38>, // Red Analog Input DC Offset
					<0x03 0x80>, // Green Analog Input Gain
					<0x04 0x38>, // Green Analog Input DC Offset
					<0x05 0x80>, // Blue Analog Input Gain
					<0x06 0x38>, // Blue Analog Input DC Offset
					<0x07 0x80>, // Mono Analog Input Gain
					<0x08 0x38>, // Mono Analog Input DC Offset
					<0x09 0x00>, // Vertical Mode Settings (SVGA 600 rows, RGB)
					<0x0A 0x02>, // HMODE (SVGA 800 columns, internal PLL, no screen saver)
					<0x0D 0x00>, // HRATE_L (Horizontal Shift Frame Rate = 0x8000 (every 9 minute))
					<0x0E 0x80>, // HRATE_U
					<0x0F 0x1E>, // PLL_L (Feedback Divider=0x41E, Post-Scaler Divider=1)
					<0x10 0x0C>, // PLL_U
					<0x11 0x0C>, // PIF (Phase Interpolator Frequency = 40 MHz)
					<0x12 0x00>, // PI2 (Phase Adjustment)
					<0x13 0xD4>, // HSTART (Horizontal Active Start Count)
					<0x14 0x19>, // VSTART (Vertical Active Start Count)
					<0x15 0xD8>, // HBLK
					<0x16 0x0C>, // HDEL
					<0x17 0x02>, // PWDN (disable MONO analog input)
					<0x18 0x80>, // ATB (power control through PWDN register)
					<0x1A 0x00>; // TRIM (automatic and periodic calibration)
	};

...
